# ğŸš€ Next.js REST API ì„œë²„ êµ¬ì¶• ì •ë¦¬

React í”„ë¡ íŠ¸ì—”ë“œ ì§€ì›ìš© **Next.js ë°±ì—”ë“œ API ì„œë²„** ì •ë¦¬ ë¬¸ì„œì…ë‹ˆë‹¤.

- ğŸ”— [Next.js ê³µì‹ ì‚¬ì´íŠ¸](https://nextjs.org/)
- ğŸŒŸ [Next.js Showcase](https://nextjs.org/showcase)

---

## 1ï¸âƒ£ í”„ë¡œì íŠ¸ ìƒì„± ë° í™˜ê²½ ì„¤ì •

### í”„ë¡œì íŠ¸ ìƒì„±
```bash
pnpm create next-app backend-nextjs \
  --typescript \
  --eslint \
  --app \
  --no-src-dir \
  --no-tailwind
íŒ¨í‚¤ì§€ ì„¤ì¹˜
ORM (Prisma)
bash
ì½”ë“œ ë³µì‚¬
pnpm add @prisma/client
pnpm add -D prisma
ì¸ì¦ (JWT)
bash
ì½”ë“œ ë³µì‚¬
pnpm add bcryptjs jsonwebtoken
pnpm add -D @types/bcryptjs @types/jsonwebtoken
OpenAI (ì„ íƒ)
bash
ì½”ë“œ ë³µì‚¬
pnpm add openai
í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env)
env
ì½”ë“œ ë³µì‚¬
DATABASE_URL="file:./data/dev.db"
JWT_SECRET="ëœë¤ 32ì ì´ìƒ ë¬¸ìì—´"
OPENAI_API_KEY="your-api-key"
ALLOWED_ORIGINS="http://localhost:3000,http://localhost:3001"
next.config.js ì„¤ì •
ts
ì½”ë“œ ë³µì‚¬
const nextConfig = {
  reactStrictMode: true,
  env: {
    DATABASE_URL: process.env.DATABASE_URL,
    JWT_SECRET: process.env.JWT_SECRET,
    OPENAI_API_KEY: process.env.OPENAI_API_KEY,
    ALLOWED_ORIGINS: process.env.ALLOWED_ORIGINS,
  },
};

module.exports = nextConfig;
2ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ (Prisma)
ORM(Object-Relational Mapping)
ê°ì²´ â†” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•˜ì—¬ SQL ì—†ì´ ë©”ì„œë“œë¡œ DB ì œì–´ ê°€ëŠ¥

ì˜ˆì‹œ
ts
ì½”ë“œ ë³µì‚¬
prisma.user.findUnique({
  where: { id: 1 },
});
ì¥ì 
ìƒì‚°ì„± í–¥ìƒ

íƒ€ì… ì•ˆì „ì„±

ìœ ì§€ë³´ìˆ˜ ìš©ì´

Prisma ì´ˆê¸°í™” & ëª…ë ¹ì–´
bash
ì½”ë“œ ë³µì‚¬
pnpm prisma init --datasource-provider sqlite
pnpm prisma db push
pnpm prisma generate
pnpm prisma db push --force-reset   # DB ì´ˆê¸°í™”
Prisma Client (Singleton)
ts
ì½”ë“œ ë³µì‚¬
import { PrismaClient } from '@prisma/client';

const globalForPrisma = global as any;

export const prisma =
  globalForPrisma.prisma ?? new PrismaClient();

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
3ï¸âƒ£ ì¸ì¦ ì‹œìŠ¤í…œ (JWT)
JWT êµ¬ì¡°
css
ì½”ë“œ ë³µì‚¬
Header.Payload.Signature
ì¸ì¦ íë¦„
ë¡œê·¸ì¸

JWT ë°œê¸‰

í´ë¼ì´ì–¸íŠ¸ê°€ Authorization í—¤ë”ì— í¬í•¨

ì„œë²„ì—ì„œ ê²€ì¦

í† í° ìƒì„± ì˜ˆì‹œ
ts
ì½”ë“œ ë³µì‚¬
import jwt from 'jsonwebtoken';

const JWT_SECRET = process.env.JWT_SECRET || 'fallback';

export function generateToken(userId: number, email: string) {
  return jwt.sign(
    { userId, email },
    JWT_SECRET,
    { expiresIn: '24h' }
  );
}
4ï¸âƒ£ ë¯¸ë“¤ì›¨ì–´ (Middleware)
Middleware: ìš”ì²­ ì „ ê³µí†µ ì²˜ë¦¬ (ì¸ì¦, CORS, ë¡œê¹… ë“±)
Route Handler: ì‹¤ì œ API ë¡œì§ ì²˜ë¦¬ (CRUD)

êµ¬ë¶„	Middleware	Route Handler
ìœ„ì¹˜	middleware.ts	app/api/**/route.ts
ì‹¤í–‰ ì‹œì 	ìš”ì²­ ì§í›„	URL ë§¤ì¹­ ì‹œ
ëŸ°íƒ€ì„	Edge Runtime	Node.js Runtime

5ï¸âƒ£ CORS ì„¤ì •
ë¸Œë¼ìš°ì € ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ ë‹¤ë¥¸ ì¶œì²˜ ìš”ì²­ ì œí•œ â†’ ì„œë²„ì—ì„œ í—ˆìš© í•„ìš”

CORS í—¤ë” ì˜ˆì‹œ
http
ì½”ë“œ ë³µì‚¬
Access-Control-Allow-Origin: http://localhost:3000
Access-Control-Allow-Methods: GET, POST, PUT, DELETE
Access-Control-Allow-Headers: Content-Type, Authorization
